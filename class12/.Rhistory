library(BiocGenerics)
library(BiocManager)
library(DESeq2)
library(GenomicRanges)
BiocManager::install("GenomicRanges")
library(BiocManager)
library(BiocGenerics)
BiocManager::install()
BiocManager::install("DESeq2")
library(DESeq2)
library(GenomicRanges)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.22")
library(GenomicRanges)
library(GenomicRanges)
BiocManager::install("GenomicRanges")
library(GenomicRanges)
library(GenomicRanges)
if("GenomicRanges" %in% .packages()) detach("package:GenomicRanges", unload=TRUE)
if("IRanges" %in% .packages()) detach("package:IRanges", unload=TRUE)
if("S4Vectors" %in% .packages()) detach("package:S4Vectors", unload=TRUE)
BiocManager::install("GenomicRanges")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GenomicRanges")
install.packages('Seqinfo')
library(S4Vectors)
library(GenomicRanges)
library(BiocVersion)
library(DESeq2)
library(DESeq2)
BiocManager::install(IRanges)
BiocManager::install("IRanges")
library(BiocManager)
library(DESeq2)
BiocManager::install("DESeq2")
library(DESeq2)
library(Biostrings)
detach("package:Biostrings", unload = TRUE)
library(Biostrings)
metadata <- read.csv("airway_metadata.csv")
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv")
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv")
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
head(counts)
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv")
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
head(counts)
head(metadata)
nrow(counts)
table(metadata$dex)
View(counts)
View(metadata)
View(counts)
sum(metadata$dex == "control")
library(dplyr)
library(DESeq2)
control <- metadata[metadata[,"dex"]=="control",]
control.counts <- counts[ ,control$id]
control.mean <- rowSums( control.counts )/4
head(control.mean)
control.mean <- rowMeans(control.counts)  # Use rowMeans() instead
head(control.mean)
treated <- metadata[metadata[,"dex"]=="treated",]
treated.counts <- counts[, treated$id]
treated.mean <- rowMeans(treated.counts)
head(treated.mean)
meancounts <- data.frame(control.mean, treated.mean)
plot(meancounts[,1],meancounts[,2])
library(ggplot2)
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()+
scale_x_log10()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()+
scale_y_log10()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()+
scale_y_log10()+ scale_x_log10()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()+
scale_y_log10()+ scale_x_log10()
meancounts$log2fc <- log2(meancounts[,"treated.mean"]/meancounts[,"control.mean"])
head(meancounts)
zero.vals <- which(meancounts[,1:2]==0, arr.ind=TRUE)
to.rm <- unique(zero.vals[,1])
mycounts <- meancounts[-to.rm,]
head(mycounts)
up.ind <- mycounts$log2fc > 2
down.ind <- mycounts$log2fc < (-2)
sum(up.ind)
sum(down.ind)
sum(up.ind)
sum(down.ind)
library(DESeq2)
citation("DESeq2")
citation("DESeq2")
library(DESeq2)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
#library(DESeq2)
rownames(metadata) <- metadata$id
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
#library(DESeq2)
metadata <- metadata[match(colnames(counts), metadata$id), ]
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
#library(DESeq2)
all(colnames(counts) %in% metadata$id)
#dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
#library(DESeq2)
all(colnames(counts) %in% metadata$id)
#dds <- DESeqDataSetFromMatrix(countData=counts,
#colData=metadata,
# design=~dex)
#dds
#library(DESeq2)
metadata <- metadata[match(colnames(counts), metadata$id), ]
#dds <- DESeqDataSetFromMatrix(countData=counts,
#colData=metadata,
# design=~dex)
#dds
#library(DESeq2)
metadata <- metadata[match(colnames(counts), metadata$id), ]
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
#library(DESeq2)
metadata <- metadata[match(colnames(counts), metadata$id), ]
rownames(metadata) <- metadata$id
#library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
dim(counts)
dim(metadata)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
dds
library(DESeq2)
identical(colnames(counts), rownames(metadata))
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
data.frame(
counts_colnames = colnames(counts),
metadata_rownames = rownames(metadata)
)
counts <- read.csv("airway_scaledcounts.csv", row.names = 1)
counts <- read.csv("C:/Users/Norman/Downloads/airway_scaledcounts.csv", row.names = 1)
counts <- read.csv("C:/Users/Norman/Downloads/airway_scaledcounts.csv", row.names = 1)
counts <- read.csv("C:/Users/Norman/Downloads/airway_scaledcounts.csv", row.names = 1)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds
library(DESeq2)
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
zero.vals <- which(meancounts[,1:2]==0, arr.ind=TRUE)
to.rm <- unique(zero.vals[,1])
mycounts <- meancounts[-to.rm,]
head(mycounts)
meancounts$log2fc <- log2(meancounts[,"treated.mean"]/meancounts[,"control.mean"])
head(meancounts)
meancounts <- data.frame(control.mean, treated.mean)
meancounts <- data.frame(control.mean, treated.mean)
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv")
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
head(counts)
head(metadata)
nrow(counts)
sum(metadata$dex == "control")
control <- metadata[metadata[,"dex"]=="control",]
control.counts <- counts[ ,control$id]
control.mean <- rowSums( control.counts )/4
head(control.mean)
control <- metadata[metadata[,"dex"]=="control",]
control.counts <- counts[, control$id]
control.mean <- rowMeans(control.counts)  # Use rowMeans() instead
head(control.mean)
treated <- metadata[metadata[,"dex"]=="treated",]
treated.counts <- counts[, treated$id]
treated.mean <- rowMeans(treated.counts)
head(treated.mean)
meancounts <- data.frame(control.mean, treated.mean)
plot(meancounts[,1],meancounts[,2])
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()
ggplot(meancounts)+
aes(control.mean, treated.mean)+
geom_point()+
scale_y_log10()+ scale_x_log10()
meancounts$log2fc <- log2(meancounts[,"treated.mean"]/meancounts[,"control.mean"])
head(meancounts)
zero.vals <- which(meancounts[,1:2]==0, arr.ind=TRUE)
to.rm <- unique(zero.vals[,1])
mycounts <- meancounts[-to.rm,]
head(mycounts)
up.ind <- mycounts$log2fc > 2
down.ind <- mycounts$log2fc < (-2)
library(DESeq2)
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
head(counts)
head(metadata)
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv")
head(counts)
head(metadata)
nrow(counts)
sum(metadata$dex == "control")
control <- metadata[metadata[,"dex"]=="control",]
control.counts <- counts[ ,control$id]
control.mean <- rowSums( control.counts )/4
head(control.mean)
control <- metadata[metadata[,"dex"]=="control",]
control.counts <- counts[, control$id]
control.mean <- rowMeans(control.counts)  # Use rowMeans() instead
head(control.mean)
treated <- metadata[metadata[,"dex"]=="treated",]
treated.counts <- counts[, treated$id]
treated.mean <- rowMeans(treated.counts)
head(treated.mean)
meancounts <- data.frame(control.mean, treated.mean)
plot(meancounts[,1],meancounts[,2])
library(DESeq2)
rownames(metadata) <- metadata$id
metadata <- metadata[match(colnames(counts), metadata$id), ]
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dim(counts)
dim(metadata)
rownames(metadata) <- metadata$id
metadata <- metadata[match(colnames(counts), metadata$id), ]
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv",row.names = 1))
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv", row.names = 1))
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv", row.names = 1))
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv", row.names = 1))
metadata <- read.csv("C:/Users/leeho/Downloads/airway_metadata.csv", row.names = 1)
counts <- read.csv("C:/Users/leeho/Downloads/airway_scaledcounts.csv", row.names = 1)
head(counts)
head(metadata)
library(DESeq2)
dim(counts)
dim(metadata)
rownames(metadata) <- metadata$id
metadata <- metadata[match(colnames(counts), metadata$id), ]
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(DESeq2)
dds<-DESeqDataSetFromMatrix(countData=counts,
colData=metadata,
design=~dex)
library(BiocManager)
library(DESeq2)
data(go.sets.hs)
data(go.subs.hs)
# Focus on Biological Process subset of GO
gobpsets = go.sets.hs[go.subs.hs$BP]
