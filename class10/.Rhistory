candy_file <- "https://raw.githubusercontent.com/fivethirtyeight/data/master/candy-power-ranking/candy-data.csv"
candy <- read.csv(candy_file, row.names = 1)
head(candy)
nrow(candy)
View(candy)
sum(candy$fruity)
candy["Nestle Crunch",]$winpercent
candy["Nestle Crunch",]$winpercent
candy["Kit Kat",]$winpercent
candy["Tootsie Roll Snack Bars",]$winpercent
library("skimr")
install.packages(c("stringr", "xfun"))
install.packages("skimr")
library(skimr)
library(dplyr)
#install.packages("skimr")
library("skimr")
skim(candy)
hist(candy$winpercent)
hist(candy$winpercent,candy)
hist(candy$winpercent,)
mean(candy$winpercent)
mean(candy$winpercent[as.logical(candy$chocolate)])
mean(candy$winpercent[as.logical(candy$fruity)])
t.test(candy$winpercent[as.logical(candy$chocolate)],
candy$winpercent[as.logical(candy$fruity)])
# Least liked (lowest winpercent)
head(candy[order(candy$winpercent), ], 5)
# Most liked (highest winpercent)
head(candy[order(-candy$winpercent), ], 5)
library(dplyr)
# Least liked
candy %>% arrange(winpercent) %>% head(5)
# Most liked
candy %>% arrange(desc(winpercent)) %>% head(5)
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_bar()
library(ggplot2)
ggplot(candy + aes(winpercent, rownames(candy)) +
geom_bar()
library(ggplot2)
ggplot(candy + aes(x=winpercent, y=rownames(candy)) +
geom_bar()
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col()
library(ggplot2)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill = "steelblue") +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(position = "dodge")) +
library(ggplot2)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col()) +
library(ggplot2)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_bar()
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_cols
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col()
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col((position = "dodge")
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col((position = position_dodge())
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col((position = "position_dodge()")
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col((position = "position_dodge()")
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col((position = position_dodge())
library(ggplot2)
options(repr.plot.width = 10, repr.plot.height = 20)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
options(repr.plot.width = 10, repr.plot.height = 20)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
options(repr.plot.width = 10, repr.plot.height = 20)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col()
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.5, position = position_dodge(0.7))
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.3, position = position_dodge(0.7))
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(width = 0.3, position = position_dodge(0.7),fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.3, position = position_dodge(0.4))
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.3, position = position_dodge(1))
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.3, position = position_dodge(0.1))
library(ggplot2)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col(width = 0.3, position = position_dodge(0.7))
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(width = 0.3, position = position_dodge(0.1),fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(width = 0.3, position = position_dodge(6),fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(width = 0.3, position = position_dodge(10),fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggplot2)
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(width = 0.3, position = position_dodge(30),fill=my_cols) +
labs(
title = "Candy Rankings by Win Percent",
x = "Win Percent",
y = "Candy"
)
library(ggrepel)
install.packages(ggrepel)
install.packages(ggrepel)
install.packages("ggrepel")
library(ggrepel)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
candy$value <- candy$winpercent / candy$pricepercent
candy[order(-candy$value), ][1:5, c("winpercent", "pricepercent")]
ord <- order(candy$pricepercent, decreasing = TRUE)
head(candy[ord, c("pricepercent", "winpercent")], 5)
install.packages(corrplot)
install.packages("corrplot")
library(corrplot)
cij <- cor(candy)
corrplot(cij)
pca <- prcomp(candy, scale = TRUE)
summary(pca)
plot(pca$x[, 1:2])
plot(pca$x[,1:2], col=my_cols, pch=16)
my_data <- cbind(candy, pca$x[,1:3])
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
my_data <- cbind(candy, pca$x[,1:3])
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
library(ggrepel)
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 7)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
install.packages("plotly")
ggplotly(p)
library(plotly)
ggplotly(p)
par(mar=c(8,4,2,2))
barplot(pca$rotation[,1], las=2, ylab="PC1 Contribution")
install.packages("webshot2")
webshot::install_phantomjs()
