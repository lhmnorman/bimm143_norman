install.packages("datapasta")
library(datapasta)
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
)
library(ggplot2)
ggplot(cdc) +
aes(Year, Cases) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)")
ggplot(cdc) +
aes(Year, Cases) +
geom_point() +
geom_line() +
# Vertical lines for wP (1946) and aP (1996)
geom_vline(xintercept = 1946, color = "blue", linetype = "dashed", size = 1) +
geom_vline(xintercept = 1996, color = "red", linetype = "dashed", size = 1) +
# Labels for the lines
annotate("text", x = 1946, y = max(cdc$Cases) * 0.95,
label = "wP", color = "blue", angle = 90, vjust = -0.5) +
annotate("text", x = 1996, y = max(cdc$Cases) * 0.95,
label = "aP", color = "red", angle = 90, vjust = -0.5) +
labs(
x = "Year",
y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
) +
theme_minimal()
library(jsonlite)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
table(subject$infancy_vac)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
table(subject$infancy_vac)
subject <- read_json("https://www.cmi-pb.org/api/subject", simplifyVector = TRUE)
head(subject, 3)
table(subject$infancy_vac)
table(subject$biological_sex)
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
)
library(ggplot2)
ggplot(cdc) +
aes(Year, Cases) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
table(subject$biological_sex, subject$race)
# Use todays date to calculate age in days
subject$age <- today() - ymd(subject$year_of_birth)
library(lubridate)
# Use todays date to calculate age in days
subject$age <- today() - ymd(subject$year_of_birth)
library(dplyr)
# aP
ap <- subject %>% filter(infancy_vac == "aP")
round( summary( time_length( ap$age, "years" ) ) )
# wP
wp <- subject %>% filter(infancy_vac == "wP")
round( summary( time_length( wp$age, "years" ) ) )
int <- ymd(subject$date_of_boost) - ymd(subject$year_of_birth)
age_at_boost <- time_length(int, "year")
head(age_at_boost)
ggplot(subject) +
aes(time_length(age, "year"),
fill=as.factor(infancy_vac)) +
geom_histogram(show.legend=FALSE) +
facet_wrap(vars(infancy_vac), nrow=2) +
xlab("Age in years")
# Complete the API URLs...
specimen <- read_json("___/specimen", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer <- read_json("https://www.cmi-pb.org/api/___", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer <- read_json("https://www.cmi-pb.org/api/ab_titer", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer     <- read_json("https://www.cmi-pb.org/api/ab_titer", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer     <- read_json("https://www.cmi-pb.org/api/titer", simplifyVector = TRUE)
library(dplyr)
meta <- left_join(specimen, subject, by = "subject_id")
dim(meta)
head(meta)
abdata <- inner_join(titer, meta, by = "specimen_id")
table(abdata$isotype)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer     <- read_json("https://www.cmi-pb.org/api/titer", simplifyVector = TRUE)
# Complete the API URLs...
specimen <- read_json("https://www.cmi-pb.org/api/specimen", simplifyVector = TRUE)
titer     <- read_json("https://www.cmi-pb.org/api/plasma_ab_titer", simplifyVector = TRUE)
library(dplyr)
meta <- left_join(specimen, subject, by = "subject_id")
dim(meta)
head(meta)
abdata <- inner_join(titer, meta, by = "specimen_id")
dim(abdata)
table(abdata$isotype)
table(abdata$dataset)
igg <- abdata %>% filter(isotype == "IgG")
head(igg)
ggplot(igg) +
aes(MFI_normalised, antigen) +
geom_boxplot() +
xlim(0, 75) +
facet_wrap(vars(visit), nrow = 2)
lter(igg, antigen == "OVA") %>%
ggplot() +
aes(MFI_normalised, col = infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
filter(igg, antigen == "OVA") %>%
ggplot() +
aes(MFI_normalised, col = infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
filter(igg, antigen == "PT") %>%
ggplot() +
aes(MFI_normalised, col = infancy_vac) +
geom_boxplot(show.legend = TRUE) +
facet_wrap(vars(visit)) +
theme_bw()
url <- "https://www.cmi-pb.org/api/v2/rnaseq?versioned_ensembl_gene_id=eq.ENSG00000211896.7"
rna <- read_json(url, simplifyVector = TRUE)
meta <- inner_join(specimen, subject)
ssrna <- inner_join(rna, meta)
ggplot(ssrna) +
aes(visit, tpm, group=subject_id) +
geom_point() +
geom_line(alpha=0.2)
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
)
library(ggplot2)
ggplot(cdc) +
aes(Year, Cases) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
ggplot(cdc) +
aes(Year, Cases) +
geom_point() +
geom_line() +
# Vertical lines for wP (1946) and aP (1996)
geom_vline(xintercept = 1946, color = "blue", linetype = "dashed", size = 1) +
geom_vline(xintercept = 1996, color = "red", linetype = "dashed", size = 1) +
# Labels for the lines
annotate("text", x = 1946, y = max(cdc$Cases) * 0.95,
label = "wP", color = "blue", angle = 90, vjust = -0.5) +
annotate("text", x = 1996, y = max(cdc$Cases) * 0.95,
label = "aP", color = "red", angle = 90, vjust = -0.5) +
labs(
x = "Year",
y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
) +
theme_minimal()
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
)
#library(ggplot2)
#ggplot(cdc) +
# aes(Year, Cases) +
# geom_point() +
# geom_line() +
# labs(x = "Year", y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
cdc <- data.frame(
Year = c(
1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,
1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,
1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,
1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,
1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,
2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,
2018,2019,2020,2021,2022,2023
),
Cases = c(
107473,164191,165418,152003,202210,181411,161799,197371,166914,172559,215343,179135,265269,
180518,147237,214652,227319,103188,183866,222202,191383,191890,109873,133792,109860,156517,
74715,69479,120718,68687,45030,37129,60886,62786,31732,28295,32148,40005,14809,11468,17749,
17135,13005,6799,7717,9718,4810,3285,4249,3036,3287,1759,2402,1738,1010,2177,2063,1623,1730,
1248,1895,2463,2276,3589,4195,2823,3450,4157,4570,2719,4083,6586,4617,5137,7796,6564,7405,
7298,7867,7580,9771,11647,25827,25616,15632,10454,13278,16858,27550,18719,48277,28639,32971,
20762,17972,18975,15609,18617,6124,2116,3044,7063
)
)
#library(ggplot2)
#ggplot(cdc) +
# aes(Year, Cases) +
# geom_point() +
# geom_line() +
# labs(x = "Year", y = "Number of cases",
title = "Pertussis Cases by Year (1922–2023)"
